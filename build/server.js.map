{"version":3,"sources":["webpack:///webpack/bootstrap 6d9c5c82ee6589c0091c","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/server.js","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/config.js","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/app/logger.js","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/app/routes.js","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/app/commandBus.js","webpack:///external \"lodash\"","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/app/commandHandlersFactory.js","webpack:///external \"JsonPersistence\"","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/app/handlers/newLadderHandler.js","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/app/handlers/nullHandler.js","webpack:///external \"express\"","webpack:///external \"body-parser\"","webpack:///c:/My Files/Copy/Development/Projects/Github/Klesk/app/handlers/joinLadderHandler.js"],"names":[],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 6d9c5c82ee6589c0091c\n **/","'use strict';\r\n\r\nimport config from './config';\r\nimport logger from './app/logger';\r\nimport routes from './app/routes';\r\n\r\nimport express from 'express';\r\nimport bodyParser from 'body-parser';\r\n\r\nvar app = express();\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\n\r\nroutes.configure(app);\r\n\r\nvar port = process.env.PORT || config.port;\r\napp.listen(port);\r\n\r\nlogger('Listening on port ' + port);\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/server.js\n **/","export default {\r\n    port: 1666,\r\n    storageFilename: 'ladders.json'\r\n};\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/config.js\n **/","'use strict';\r\n\r\nexport default function(message) {\r\n    console.log(message);\r\n}\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/app/logger.js\n **/","'use strict';\r\n\r\nimport logger from './logger';\r\nimport commandBus from './commandBus';\r\n\r\nlet configure = function(app) {\r\n\r\n    app.get('/', (req, res) => {\r\n        res.end(\"hello from Klesk\");\r\n    });\r\n\r\n    app.post('/', (req, res) => {\r\n        commandBus.dispatch(req.body, (error, response) => {\r\n            logger(req.body);\r\n            res.end(JSON.stringify(response));\r\n        });\r\n    });\r\n};\r\n\r\nexport default {\r\n    configure: configure\r\n};\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/app/routes.js\n **/","'use strict';\r\n\r\nimport _ from 'lodash';\r\nimport handlersFactory from './commandHandlersFactory';\r\n\r\nexport default {\r\n    dispatch(command, callback) {\r\n        let parsedCommandArguments = _.words(command.text);\r\n        let commandType = parsedCommandArguments[0];\r\n\r\n        let parsedCommand = {\r\n            playerName: command.user_name,\r\n            arguments: parsedCommandArguments\r\n        };\r\n\r\n        let commandHandler = handlersFactory.getCommandHandler(commandType);\r\n        let result = commandHandler.makeItSo(parsedCommand, callback);\r\n\r\n        return result;\r\n    }\r\n};\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/app/commandBus.js\n **/","module.exports = require(\"lodash\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"lodash\"\n ** module id = 5\n ** module chunks = 0\n **/","'use strict';\r\n\r\nimport Persistence from 'JsonPersistence';\r\n\r\nimport newLadderHandler from './handlers/newLadderHandler';\r\nimport joinLadderHandler from './handlers/joinLadderHandler';\r\nimport thisIsNotTheCommandYouAreLookingFor from './handlers/nullHandler';\r\nimport config from '../config';\r\nimport logger from './logger';\r\n\r\nlet jsonPersistence = new Persistence(config.storageFilename);\r\njsonPersistence.init((error) => {\r\n    logger(error);\r\n});\r\n\r\nlet commandTypes = {\r\n    NEWLADDER: 'newladder',\r\n    JOINLADDER: 'joinladder'\r\n};\r\n\r\nlet getCommandHandler = function(commandType) {\r\n    switch(commandType) {\r\n        case commandTypes.NEWLADDER:\r\n            return newLadderHandler(jsonPersistence);\r\n\r\n        case commandTypes.JOINLADDER:\r\n            return joinLadderHandler(jsonPersistence);\r\n\r\n        default:\r\n            return thisIsNotTheCommandYouAreLookingFor();\r\n    }\r\n};\r\n\r\nexport default {\r\n    getCommandHandler: getCommandHandler\r\n};\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/app/commandHandlersFactory.js\n **/","module.exports = require(\"JsonPersistence\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"JsonPersistence\"\n ** module id = 7\n ** module chunks = 0\n **/","'use strict';\r\n\r\nfunction Ladder(name) {\r\n    return {\r\n        name: name,\r\n        matches: []\r\n    };\r\n}\r\n\r\nlet newLadderHandler = function(persistence) {\r\n    return {\r\n        makeItSo(parsedCommand, callback) {\r\n            let ladderName = parsedCommand.arguments[1];\r\n\r\n            persistence.add(Ladder(ladderName), (error) => {\r\n                if (error) {\r\n                    callback(error.message, null);\r\n                }\r\n\r\n                callback(null, 'Created new ladder: ' + ladderName);\r\n            });\r\n        }\r\n    };\r\n};\r\n\r\nexport default newLadderHandler;\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/app/handlers/newLadderHandler.js\n **/","'use strict';\r\n\r\nlet thisIsNotTheCommandYouAreLookingFor = function() {\r\n    return {\r\n        makeItSo(parsedCommand, callback) {\r\n            callback(null, 'This is not the command you are looking for.');\r\n        }\r\n    };\r\n};\r\n\r\nexport default thisIsNotTheCommandYouAreLookingFor;\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/app/handlers/nullHandler.js\n **/","module.exports = require(\"express\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 10\n ** module chunks = 0\n **/","module.exports = require(\"body-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"body-parser\"\n ** module id = 11\n ** module chunks = 0\n **/","'use strict';\r\n\r\nimport _ from 'lodash';\r\nimport logger from '../logger';\r\n\r\nconst RESULT_MESSAGE = 'Added: ';\r\n\r\nlet newLadderHandler = function(persistence) {\r\n    function _thereAreNoOtherPlayers(matches) {\r\n        return matches.length === 0;\r\n    }\r\n\r\n    function _thereIsOnlyOnePlayer(matches) {\r\n        return matches.length === 1 &&\r\n            (matches[0].player1 === '' || matches[0].player2 === '');\r\n    }\r\n\r\n    function _addNewPlayerToMatch(match, player) {\r\n        if (match.player1 === '') {\r\n            match.player1 = player;\r\n            return;\r\n        }\r\n\r\n        match.player2 = player;\r\n    }\r\n\r\n    return {\r\n        makeItSo(parsedCommand, callback) {\r\n            let ladderName = parsedCommand.arguments[1];\r\n            let playerName = parsedCommand.playerName;\r\n\r\n            let queryLadder = (ladder) => {\r\n                return ladder.name === ladderName;\r\n            };\r\n\r\n            let updateCallback = (ladder) => {\r\n                if (_thereAreNoOtherPlayers(ladder.matches)) {\r\n                    ladder.matches.push({ player1: playerName, player2: '', winner: '' });\r\n\r\n                    callback(RESULT_MESSAGE + playerName);\r\n                    return;\r\n                }\r\n\r\n                if (_thereIsOnlyOnePlayer(ladder.matches)) {\r\n                    _addNewPlayerToMatch(ladder.matches[0], playerName);\r\n\r\n                    callback(RESULT_MESSAGE + playerName);\r\n                    return;\r\n                }\r\n\r\n                let allPlayersInLadder = _(ladder.matches)\r\n                    .map((match) => {\r\n                        return [ match.player1, match.player2 ];\r\n                    })\r\n                    .flatten()\r\n                    .uniq()\r\n                    .value();\r\n\r\n                let newMatchesToPlay = _.map(allPlayersInLadder, (player) => {\r\n                    return { player1: playerName, player2: player, winner: '' };\r\n                });\r\n\r\n                let allMatches = ladder.matches;\r\n\r\n                let matches = allMatches.concat(newMatchesToPlay);\r\n\r\n                ladder.matches = matches;\r\n            };\r\n\r\n            persistence.update(queryLadder, updateCallback, (error) => {\r\n                if (error) { logger(error) }\r\n                logger('updejtuje');\r\n                callback(null, RESULT_MESSAGE + playerName);\r\n            });\r\n        }\r\n    };\r\n};\r\n\r\nexport default newLadderHandler;\n\n\n/** WEBPACK FOOTER **\n ** c:/My Files/Copy/Development/Projects/Github/Klesk/app/handlers/joinLadderHandler.js\n **/"],"sourceRoot":""}